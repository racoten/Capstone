Inside `diveintoansible/Ansible Architecture and Design/Inventories/01`, there are 2 files:
- `ansible.cfg`
- `hosts`

`ansible.cfg` contains simple configurations, in this case it is specifying the list of inventories it contains:
```bash
[default]
inventory = hosts
```

`hosts` contains a list of hosts that we want to interact with which is referenced by `ansible.cfg`:
```bash
[all]
centos1
```

We can now ping without manually specifying the inventory since it is already set in `ansible.cfg` config file:
```bash
ansible all -m ping
```

![[Pasted image 20230809085427.png]]

This works because we already have `centos1` as a known host. We can also specify `ANSIBLE_HOST_KEY_CHECKING=false` to ignore the fingerprint check when trying to ssh:
```bash
ANSIBLE_HOST_KEY_CHECKING=false ansible all -m ping
```

![[Pasted image 20230809085756.png]]

Or we can set it up in our configuration file:
```bash
[default]
inventory = hosts
host_key_checking = false
```

![[Pasted image 20230809085937.png]]

By structuring inventories using explicit groups, we can control what hosts we can actually interact with:
```bash
[centos] # <- explicit group for the centos hosts
centos1
centos2
centos3

[ubuntu] # <- explicit group for the ubuntu hosts
ubuntu1
ubuntu2
ubuntu3
```

We can now ping all, or manually ping specified groups in `[]` identifier:
```bash
ansible ping centos -m ping
```

![[Pasted image 20230809090426.png]]

```bash
ansible ubuntu -m ping
```

![[Pasted image 20230809090504.png]]

We can also ping all hosts using `*` wildcard inside quotation marks:
```bash
ansible '*' -m ping
```

![[Pasted image 20230809090821.png]]

The output always seems too much, we can condense it using the `-o` flag:
```bash
ansible all -m ping -o
```

![[Pasted image 20230809090938.png]]

To figure out which hosts exist in each group, specify the the name of the group followed by `--list-host` flag:
```bash
ansible centos --list-hosts
```

![[Pasted image 20230809091130.png]]

List all hosts:
```bash
ansible all --list-hosts
```

![[Pasted image 20230809091226.png]]

Or and individual host:
```bash
ansible centos1 --list-hosts
```

![[Pasted image 20230809091308.png]]

We can also use regex to specify hosts:
```bash
ansible ~.*3 --list-hosts
```

- `~` specifies that the command will contain a regex
- `.` specify any character
- `*` specify any number of previous characters
- `3` match those that end with `3`

![[Pasted image 20230809091606.png]]

Sometimes, we may need to have elevated access to interact and administer hosts in an inventory, we can set up a variable to specify which user to use when performing actions on remote hosts:
```bash
[centos]
centos1 ansible_user=root
centos2 ansible_user=root
centos3 ansible_user=root

[ubuntu]
ubuntu1
ubuntu2
ubuntu3
```

We can check our ID using the `command` module to run an OS command:
```bash
ansible all -m command -a 'id' -o
```

![[Pasted image 20230809092029.png]]

However it is overkill to use the root user when interacting with remote hosts, we can use the `ansible_become*` variable to become superuser in hosts that have it set up in:
```bash
[centos]
centos1 ansible_user=root
centos2 ansible_user=root
centos3 ansible_user=root

[ubuntu]
ubuntu1 ansible_become=true ansible_become_pass=password
ubuntu2 ansible_become=true ansible_become_pass=password
ubuntu3 ansible_become=true ansible_become_pass=password
```

![[Pasted image 20230809092450.png]]

