
# Challenge

1. Configure hosts file to target the Linux group
2. Install the package `epel-release` and take into account ubuntu and centos' package manager (i.e. `apt` and `yum` or `dnf`)
	1. Give the task a name of `Install Epell`
	2. Use the following options:
		```yaml
		update_cache: yes
		state: latest
		```
3. Target only the CentOS hosts for this using the fact `ansible_distribution` with value centos

Initial code

```yaml
---
- hosts: linux
  tasks:
  - name: Install Epel CentOS
    yum:
      name: epel-release
      state: latest
      update_cache: yes
    when: ansible_distribution == "CentOS"
    notify: Install for CentOS Hosts

  handlers:
  - name: Install for CentOS Hosts
    debug:
      msg: Epel has been installed for CentOS hosts
...
```

4. Install NGINX on both CentOS and Ubuntu

```yaml
---
- hosts: linux
  tasks:
  - name: Install Nginx CentOS
    yum:
      name: nginx
      state: latest
      update_cache: yes
    when: ansible_distribution == "CentOS"
    notify: Install for CentOS Hosts

  - name: Install Nginx Ubuntu
    apt:
      name: nginx
      state: latest
      update_cache: yes
    when: ansible_distribution == "Ubuntu"
    notify: Install for Ubuntu Hosts

  handlers:
  - name: Install for CentOS Hosts
    debug:
      msg: Nginx has been installed for CentOS hosts

  - name: Install for Ubuntu Hosts
    debug:
      msg: Nginx has been installed for Ubuntu hosts
...
```

5. Repeat the steps but with the `package` module to simplify it

```yaml
---
 - hosts: linux

   tasks:
   - name: Install nginx Universally
	 ansible.builtin.package:
	  name: nginx
	  state: latest
	  update_cache: yes
	 notify: Installed Nginx on all Hosts

   handlers:
   - name: Installed Nginx on all Hosts
     debug:
       msg: Nginx has been installed for Ubuntu hosts
...
```

6. Use the service module to restart nginx on all hosts

```yaml
---
 - hosts: linux

   tasks:
   - name: Restart nginx Universally
	 service:
	   name: nginx
	   state: restarted
	 notify: Restart Nginx on all Hosts

   handlers:
   - name: Restart Nginx on all Hosts
     debug:
       msg: Nginx has been restarted for all hosts
...
```

7. Create a handler named 'Check HTTP Service' to check if nginx is running on the default port correctly

```yaml
---
 - hosts: linux

   tasks:
   - name: Restart nginx Universally
     service:
       name: nginx
       state: restarted
     notify: Check HTTP Service

   handlers:
   - name: Check HTTP Service
     uri:
       url: http://{{ ansible_default_ipv4.address }}
       status_code: 200
...
```

8. Transfer the Jinja2 template to remote hosts as `index.html`

```yaml
---
 - hosts: linux

   vars:
     path_centos: /usr/share/nginx/html
     path_ubuntu: /var/www/html

   tasks:
   - name: Template index.html-base.j2 to index.html on Ubuntu target
     copy:
       src: index.html-base.j2
       dest: "{{ path_ubuntu }}/index.html"
       mode: 644
     when: ansible_distribution == "Ubuntu"

   - name: Template index.html-base.j2 to index.html on CentOS target
     copy:
       src: index.html-base.j2
       dest: "{{ path_centos }}/index.html"
       mode: 644
     when: ansible_distribution == "CentOS"
...
```